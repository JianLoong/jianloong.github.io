<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Hacker News Word Cloud  | Jian</title>
<meta name="keywords" content="Hacker News, Chart, Visualisation">
<meta name="description" content="The word cloud generated here is based on the website hacker news.
The reason this post is; is so that it would easier to see the word that appeared the most for the day.
Even though the use of a word cloud is not exactly a good representation of occurrence, it still looks nice.
Please note that the posts here are generated based on the Hacker News API by doing GET requests.">
<meta name="author" content="Jian">
<link rel="canonical" href="https://jian.sh/posts/2019/hackernews_word_cloud/">
<meta name="google-site-verification" content="UA-55422968-1">
<link href="http://fonts.cdnfonts.com/css/atkinson-hyperlegible" rel="stylesheet">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://jian.sh/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://jian.sh/images/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jian.sh/images/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jian.sh/images/apple-touch-icon.png">
<link rel="mask-icon" href="https://jian.sh/images/apple-touch-icon-180x180.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-55422968-1', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="Hacker News Word Cloud " />
<meta property="og:description" content="The word cloud generated here is based on the website hacker news.
The reason this post is; is so that it would easier to see the word that appeared the most for the day.
Even though the use of a word cloud is not exactly a good representation of occurrence, it still looks nice.
Please note that the posts here are generated based on the Hacker News API by doing GET requests." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jian.sh/posts/2019/hackernews_word_cloud/" />
<meta property="og:image" content="https://jian.sh/images/hackernews.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-14T20:56:02+11:00" />
<meta property="article:modified_time" content="2019-10-14T20:56:02+11:00" /><meta property="og:site_name" content="Jian" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://jian.sh/images/hackernews.png" />
<meta name="twitter:title" content="Hacker News Word Cloud "/>
<meta name="twitter:description" content="The word cloud generated here is based on the website hacker news.
The reason this post is; is so that it would easier to see the word that appeared the most for the day.
Even though the use of a word cloud is not exactly a good representation of occurrence, it still looks nice.
Please note that the posts here are generated based on the Hacker News API by doing GET requests."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://jian.sh/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Hacker News Word Cloud ",
      "item": "https://jian.sh/posts/2019/hackernews_word_cloud/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hacker News Word Cloud ",
  "name": "Hacker News Word Cloud ",
  "description": "The word cloud generated here is based on the website hacker news.\nThe reason this post is; is so that it would easier to see the word that appeared the most for the day.\nEven though the use of a word cloud is not exactly a good representation of occurrence, it still looks nice.\nPlease note that the posts here are generated based on the Hacker News API by doing GET requests.",
  "keywords": [
    "Hacker News", "Chart", "Visualisation"
  ],
  "articleBody": "\rThe word cloud generated here is based on the website hacker news.\nThe reason this post is; is so that it would easier to see the word that appeared the most for the day.\nEven though the use of a word cloud is not exactly a good representation of occurrence, it still looks nice.\nPlease note that the posts here are generated based on the Hacker News API by doing GET requests. So, it is based on their current entries. So, it will be refreshed when the page is reloaded.\n",
  "wordCount" : "90",
  "inLanguage": "en",
  "image":"https://jian.sh/images/hackernews.png","datePublished": "2019-10-14T20:56:02+11:00",
  "dateModified": "2019-10-14T20:56:02+11:00",
  "author":{
    "@type": "Person",
    "name": "Jian"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jian.sh/posts/2019/hackernews_word_cloud/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jian",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jian.sh/images/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jian.sh/" accesskey="h" title="Jian (Alt + H)">Jian</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://jian.sh/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/projects/" title="projects">
                    <span>projects</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/archives/" title="archives">
                    <span>archives</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/contact/" title="contact">
                    <span>contact</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://jian.sh/">Home</a>&nbsp;»&nbsp;<a href="https://jian.sh/posts/">Posts</a></div>
    <h1 class="post-title">
      Hacker News Word Cloud 
    </h1>
    <div class="post-meta"><span title='2019-10-14 20:56:02 +1100 AEDT'>October 14, 2019</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Jian

</div>
  </header> 
  <div class="post-content"><script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://rawgit.com/jasondavies/d3-cloud/master/build/d3.layout.cloud.js"></script>
  <div class="column" id="cloud">
  </div>
<p>The word cloud generated here is based on the website hacker news.</p>
<p>The reason this post is; is so that it would easier to see the word that appeared the most for the day.</p>
<p>Even though the use of a word cloud is not exactly a good representation of occurrence, it still looks nice.</p>
<p>Please note that the posts here are generated based on the Hacker News API by doing <code>GET</code> requests. So, it is based on their current entries. So, it will be <strong>refreshed</strong> when the page is reloaded.</p>
<script>

// Based on http://bl.ocks.org/joews/9697914 with modifications.
let words = "";
let freq = [""];
let arr = "";

var stopWords = [
  'about', 'after', 'all', 'also', 'am', 'an', 'and', 'another', 'any', 'are', 'as', 'at', 'be',
  'because', 'been', 'before', 'being', 'between', 'both', 'but', 'by', 'came', 'can',
  'come', 'could', 'did', 'do', 'each', 'for', 'from', 'get', 'got', 'has', 'had',
  'he', 'have', 'her', 'here', 'him', 'himself', 'his', 'how', 'if', 'in', 'into',
  'is', 'it', 'like', 'make', 'many', 'me', 'might', 'more', 'most', 'much', 'must',
  'my', 'never', 'now', 'of', 'on', 'only', 'or', 'other', 'our', 'out', 'over',
  'said', 'same', 'see', 'should', 'since', 'some', 'still', 'such', 'take', 'than',
  'that', 'the', 'their', 'them', 'then', 'there', 'these', 'they', 'this', 'those',
  'through', 'to', 'too', 'under', 'up', 'very', 'was', 'way', 'we', 'well', 'were',
  'what', 'where', 'which', 'while', 'who', 'with', 'would', 'you', 'your', 'a', 'i', 'its', 'why', '', 'ask','hn','s'
];

// https://stackoverflow.com/questions/5631422/stop-word-removal-in-javascript

function removeStopWords(str) {
    res = []
    words = str.split(' ')
    for(i=0;i<words.length;i++) {
        if(!stopWords.includes(words[i])) {
            res.push(words[i])
        }
    }
    return(res.join(' '))
  }

//Simple animated example of d3-cloud - https://github.com/jasondavies/d3-cloud
//Based on https://github.com/jasondavies/d3-cloud/blob/master/examples/simple.html

// Encapsulate the word cloud functionality
function wordCloud(selector) {

    var fill = d3.scale.category20();

    //Construct the word cloud's SVG element
    var svg = d3.select(selector).append("svg")
        .attr("viewBox", `0 0 800 800`)
        .append("g")
        .attr("transform", "translate(400,400)");


    //Draw the word cloud
    function draw(words) {
        var cloud = svg.selectAll("g text")
                        .data(words, function(d) { return d.text; })

        //Entering words
        cloud.enter()
            .append("text")
            .style("font-family", "Impact")
            .style("fill", function(d, i) { return fill(i); })
            .attr("text-anchor", "middle")
            .attr('font-size', 1)
            .text(function(d) { return d.text; });

        //Entering and existing words
        cloud
            .transition()
                .duration(600)
                .style("font-size", function(d) { return d.size + "px"; })
                .attr("transform", function(d) {
                    return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                })
                .style("fill-opacity", 1);

        //Exiting words
        cloud.exit()
            .transition()
                .duration(200)
                .style('fill-opacity', 1e-6)
                .attr('font-size', 1)
                .remove();
    }

    return {


        update: function(words) {

            d3.layout.cloud().size([800, 800])
                .words(words)
                .padding(5)
                .rotate(function() { return ~~(Math.random() * 2) * 90; })
                .font("Impact")
                .fontSize(function(d) { return d.size; })
                .on("end", draw)
                .start();
        }
    }

}

function getWords(i) {
    arr = words.split(" ");
    let freq = calculateFrequency(arr);
        
    return buildResult(arr);

}
function showNewWords(vis, i) {
    i = i || 0;

    vis.update(getWords(i ++ % words.length))    
}

//Create a new instance of the word cloud visualisation.
var myWordCloud = wordCloud('#cloud');


function calculateFrequency(arr) {
  var a = [],
    b = [],
    prev;
  arr.sort();
  for (var i = 0; i < arr.length; i++) {
    if (arr[i] !== prev) {
      a.push(arr[i]);
      b.push(1);
    } else {
      b[b.length - 1]++;
    }
    prev = arr[i];
  }
  return [a, b];
}

function buildResult(arr) {
  let resultArr = [];
  let sum = 0;

  let total = freq[0].length | 0

  for (let i = 0; i < total; i++)
    resultArr.push({
      text: freq[0][i],
      size: freq[1][i]
    });

  let sorted = resultArr.sort((a, b) => b.size - a.size);
  sorted = sorted.slice(0, 50);
  for (let i = 0; i < sorted.length; i++) sum += sorted[i].size;

  resultArr = [];
  for (let i = 0; i < sorted.length; i++)
    resultArr.push({
      text: sorted[i]["text"],
      size: (sorted[i]["size"] / sum) * 60 + 50
    });

  return resultArr;
}

function getPage(pageNumber){
  let endPoint = "https://api.hnpwa.com/v0/news/" + pageNumber + ".json";
  return fetch(endPoint, {
    mode: "cors"
  }).then((response) => response.json())
};


function getPages(noOfPages){
  let promiseArray = [];
  for(let i = 1; i < noOfPages; i++){
      promiseArray.push(getPage(i));
  }
  return Promise.all(promiseArray);
}

function process(noOfPages){
  getPages(noOfPages)
    .then((result) => {
      let titles = [];
      for(let i = 0; i < result.length; i++) {
          //console.log(result);
          for(let a =0; a < result[i].length; a++) {
              words += " " + (result[i][a].title);
          }
      }

      words = words.replace(/[^\w\s]/gi, '');
      words = words.replace(/\d/g, '');
      words = removeStopWords(words.toLowerCase());
      arr = words.split(" ");
      freq = calculateFrequency(arr);
      showNewWords(myWordCloud);
    })
}

  const noOfPages = 20;

  process(noOfPages);

</script>
<style>


@media only screen and (min-width: 1000px)  {
  .row {
    display: flex !important;
  }
  .column {
    flex: 50% !important;
  }

}
</style>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://jian.sh/tags/hacker-news/">Hacker News</a></li>
      <li><a href="https://jian.sh/tags/chart/">Chart</a></li>
      <li><a href="https://jian.sh/tags/visualisation/">Visualisation</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://jian.sh/posts/2019/simplegeneticalgo/">
    <span class="title">« Prev</span>
    <br>
    <span>Genetic Algorithm using Web Workers</span>
  </a>
  <a class="next" href="https://jian.sh/posts/2019/hk/">
    <span class="title">Next »</span>
    <br>
    <span>Sentiment analysis for the subreddit Hong Kong</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://jian.sh/">Jian</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
