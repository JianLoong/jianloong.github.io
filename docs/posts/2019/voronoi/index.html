<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>k-Nearest Neighbour on Maps | Jian</title>
<meta name="keywords" content="Nearest Neighbour, Maps, Voronoi">
<meta name="description" content="One of the most common queries when working with maps is the nearest neighbour query. This blog post will use Voronoi Diagrams to explain more regarding the nearest neighbour query.
Below is an example of a Voronoi diagram generated using d3.js. One of the good use cases of a voronoi diagram in real-life applications would be where would be finding a place to build emergency services. This place should have the most number of neighbouring regions.">
<meta name="author" content="Jian">
<link rel="canonical" href="https://jian.sh/posts/2019/voronoi/">
<meta name="google-site-verification" content="UA-55422968-1">
<link href="http://fonts.cdnfonts.com/css/atkinson-hyperlegible" rel="stylesheet">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://jian.sh/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://jian.sh/images/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jian.sh/images/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jian.sh/images/apple-touch-icon.png">
<link rel="mask-icon" href="https://jian.sh/images/apple-touch-icon-180x180.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-55422968-1', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="k-Nearest Neighbour on Maps" />
<meta property="og:description" content="One of the most common queries when working with maps is the nearest neighbour query. This blog post will use Voronoi Diagrams to explain more regarding the nearest neighbour query.
Below is an example of a Voronoi diagram generated using d3.js. One of the good use cases of a voronoi diagram in real-life applications would be where would be finding a place to build emergency services. This place should have the most number of neighbouring regions." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jian.sh/posts/2019/voronoi/" />
<meta property="og:image" content="https://jian.sh/images/voronoi.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-10-27T00:00:00+00:00" /><meta property="og:site_name" content="Jian" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://jian.sh/images/voronoi.png" />
<meta name="twitter:title" content="k-Nearest Neighbour on Maps"/>
<meta name="twitter:description" content="One of the most common queries when working with maps is the nearest neighbour query. This blog post will use Voronoi Diagrams to explain more regarding the nearest neighbour query.
Below is an example of a Voronoi diagram generated using d3.js. One of the good use cases of a voronoi diagram in real-life applications would be where would be finding a place to build emergency services. This place should have the most number of neighbouring regions."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://jian.sh/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "k-Nearest Neighbour on Maps",
      "item": "https://jian.sh/posts/2019/voronoi/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "k-Nearest Neighbour on Maps",
  "name": "k-Nearest Neighbour on Maps",
  "description": "One of the most common queries when working with maps is the nearest neighbour query. This blog post will use Voronoi Diagrams to explain more regarding the nearest neighbour query.\nBelow is an example of a Voronoi diagram generated using d3.js. One of the good use cases of a voronoi diagram in real-life applications would be where would be finding a place to build emergency services. This place should have the most number of neighbouring regions.",
  "keywords": [
    "Nearest Neighbour", "Maps", "Voronoi"
  ],
  "articleBody": "\rOne of the most common queries when working with maps is the nearest neighbour query. This blog post will use Voronoi Diagrams to explain more regarding the nearest neighbour query.\nBelow is an example of a Voronoi diagram generated using d3.js. One of the good use cases of a voronoi diagram in real-life applications would be where would be finding a place to build emergency services. This place should have the most number of neighbouring regions. For example, if you click on the region in the Voronoi diagram below, you can see how many regions in which it would consider this region to be its neighbour. The diagram is randomly generated based on a number of points and thus every refresh of this page will show a different Voronoi diagram.\nFig 1. Voronoi Diagram generated with 30 random points\nThe codes to create this diagram are as follows :-\nconst createVoronoi = () =\u003e { const width = 600; const height = 600; const vertices = d3.range(30).map(function (d) { return [Math.random() * width, Math.random() * height]; }); const delaunay = d3.Delaunay.from(vertices); const voronoi = delaunay.voronoi([0, 0, width, height]); let svg = d3.select(\"#canvas\").append(\"svg\").attr(\"viewBox\", `0 0 600 600`); const mesh = svg .append(\"path\") .attr(\"fill\", \"none\") .attr(\"stroke\", \"#ccc\") .attr(\"stroke-width\", 1) .attr(\"d\", voronoi.render()); const bounds = svg .append(\"path\") .attr(\"fill\", \"none\") .attr(\"stroke\", \"#ccc\") .attr(\"stroke-width\", 1) .attr(\"d\", voronoi.renderBounds()); const points = svg .append(\"path\") .attr(\"fill\", \"black\") .attr(\"stroke\", \"#ccc\") .attr(\"stroke-width\", 1) .attr(\"d\", delaunay.renderPoints()); }; Example of a query I will now re-use my data set of point from an earlier blog entry and I will generate the voronoi diagram. Basically, I would use a query point as well to find out the nearest neighbour and the surrounding neighbours. The figure below shows that the d3-delaunay provides a simple functions that allows you to find the point in which is the closest to the query point. This is done by using delaunay.find(). So if you are inside the blue region, your closest point would be the point inside the blue region.\nIt’s surrounding neighbours could then be easily obtained once you have this point by using delaunay.neighbor() and passing the result of the first find function. So, the regions which are in teal would be the neighbours of the region in blue. All the other regions would be coloured in green. This simple data structure would allow you to easily obtain the nearest neighbour. However, of course, there is also the importance of the build time, insertion time and removal time as well.\nFig 2. Voronoi Diagram for a NN query.\nThe codes to create this diagram are as follows const queryExample = () =\u003e { let points = [ [40, 74], [34, 118], [41, 87], [44, 93], [39, 104], [32, 96], [47, 122], [42, 71], ]; // Function to transform the points so that it would work on the grid const transform = (point) =\u003e { return [(point[0] / 90) * 500, (point[1] / 180) * 500]; }; let transformed = []; points.forEach((element) =\u003e { transformed.push(transform(element)); }); const delaunay = d3.Delaunay.from(points); const voronoi = delaunay.voronoi([0, 0, 500, 500]); // Call the draw Voronoi function. drawVoronoi(\"#exampleQuery\", transformed); }; const drawVoronoi = (id, vertices, color) =\u003e { const width = 500, height = 500; const delaunay = d3.Delaunay.from(vertices); const voronoi = delaunay.voronoi([0, 0, width, height]); let svg = d3.select(id).append(\"svg\").attr(\"viewBox\", `0 0 500 500`); const mesh = svg .append(\"path\") .attr(\"fill\", \"none\") .attr(\"stroke\", \"#ccc\") .attr(\"stroke-width\", 1) .attr(\"d\", voronoi.render()); const bounds = svg .append(\"path\") .attr(\"fill\", \"none\") .attr(\"stroke\", \"#ccc\") .attr(\"stroke-width\", 1) .attr(\"d\", voronoi.renderBounds()); // Find the closest point to this coordinate. const ans = delaunay.find(40, 73); const neighbours = delaunay.neighbors(ans); for (const iterator of neighbours) { renderCell(svg, voronoi, iterator, d3.schemeTableau10[3]); } renderCell(svg, voronoi, ans, d3.schemeTableau10[0]); const points = svg .append(\"path\") .attr(\"fill\", \"black\") .attr(\"stroke\", \"#ccc\") .attr(\"stroke-width\", 1) .attr(\"d\", delaunay.renderPoints()); }; const renderCell = (svg, voronoi, index, color) =\u003e { svg .append(\"path\") .attr(\"fill\", color) .attr(\"stroke\", \"#ccc\") .attr(\"stroke-width\", 1) .attr(\"d\", voronoi.renderCell(index)); }; Lessons from this blog post. The learning curve for d3.js is pretty insane. Voronoi are pretty easy using d3. Generators can be iterated using the for...of construct. MDN link There is a way to make SVG responsive. Refer this post. ",
  "wordCount" : "685",
  "inLanguage": "en",
  "image":"https://jian.sh/images/voronoi.png","datePublished": "2019-10-27T00:00:00Z",
  "dateModified": "2019-10-27T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Jian"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jian.sh/posts/2019/voronoi/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jian",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jian.sh/images/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jian.sh/" accesskey="h" title="Jian (Alt + H)">Jian</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://jian.sh/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/projects/" title="projects">
                    <span>projects</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/archives/" title="archives">
                    <span>archives</span>
                </a>
            </li>
            <li>
                <a href="https://jian.sh/contact/" title="contact">
                    <span>contact</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://jian.sh/">Home</a>&nbsp;»&nbsp;<a href="https://jian.sh/posts/">Posts</a></div>
    <h1 class="post-title">
      k-Nearest Neighbour on Maps
    </h1>
    <div class="post-meta"><span title='2019-10-27 00:00:00 +0000 UTC'>October 27, 2019</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Jian

</div>
  </header> 
  <div class="post-content"><script src="https://unpkg.com/d3@5.12.0/dist/d3.min.js"></script>
<script src="/posts/d3-delaunday.min.js"></script>
<p>One of the most common queries when working with maps is the nearest neighbour query. This blog post will use Voronoi Diagrams to explain more regarding the nearest neighbour query.</p>
<p>Below is an example of a Voronoi diagram generated using d3.js. One of the good use cases of a voronoi diagram in real-life applications would be where would be <strong>finding a place to build emergency services.</strong> This place should have the most number of neighbouring regions. For example, if you <code>click</code> on the region in the Voronoi diagram below, you can see how many regions in which it would consider this region to be its neighbour. The diagram is randomly generated based on a number of points and thus every refresh of this page will show a different Voronoi diagram.</p>
<div id="canvas" style="text-align:center;max-width:30em;margin:auto;"></div>
<p align="center"><strong>Fig 1. Voronoi Diagram generated with 30 random points</strong></p>
<!-- <embed src="https://www.desmos.com/calculator/q0nyt99bcr?embed" width="100%" height="500px" style="border: 1px solid #ccc" frameborder=0></embed> -->
<p>The codes to create this diagram are as follows :-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">createVoronoi</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">vertices</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">30</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">width</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">height</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">delaunay</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">Delaunay</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">vertices</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">voronoi</span> <span class="o">=</span> <span class="nx">delaunay</span><span class="p">.</span><span class="nx">voronoi</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&#34;#canvas&#34;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;svg&#34;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;viewBox&#34;</span><span class="p">,</span> <span class="sb">`0 0 600 600`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">mesh</span> <span class="o">=</span> <span class="nx">svg</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;path&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;fill&#34;</span><span class="p">,</span> <span class="s2">&#34;none&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke&#34;</span><span class="p">,</span> <span class="s2">&#34;#ccc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke-width&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="nx">voronoi</span><span class="p">.</span><span class="nx">render</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">bounds</span> <span class="o">=</span> <span class="nx">svg</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;path&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;fill&#34;</span><span class="p">,</span> <span class="s2">&#34;none&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke&#34;</span><span class="p">,</span> <span class="s2">&#34;#ccc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke-width&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="nx">voronoi</span><span class="p">.</span><span class="nx">renderBounds</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">points</span> <span class="o">=</span> <span class="nx">svg</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;path&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;fill&#34;</span><span class="p">,</span> <span class="s2">&#34;black&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke&#34;</span><span class="p">,</span> <span class="s2">&#34;#ccc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke-width&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="nx">delaunay</span><span class="p">.</span><span class="nx">renderPoints</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><h4 id="example-of-a-query">Example of a query<a hidden class="anchor" aria-hidden="true" href="#example-of-a-query">#</a></h4>
<p>I will now re-use my data set of point from an earlier blog entry and I will generate the voronoi diagram. Basically, I would use a query point as well to find out the nearest neighbour and the surrounding neighbours. The figure below shows that the d3-delaunay provides a simple functions that allows you to find the point in which is the closest to the query point. This is done by using <code>delaunay.find()</code>. So if you are <strong>inside the blue region</strong>, your closest point would be the point inside the blue region.</p>
<p>It&rsquo;s surrounding neighbours could then be easily obtained once you have this point by using <code>delaunay.neighbor()</code> and passing the result of the first find function. So, the regions which are in teal would be the <strong>neighbours of the region in blue</strong>. All the other regions would be coloured in green. This simple data structure would allow you to easily obtain the nearest neighbour. However, of course, there is also the importance of the build time, insertion time and removal time as well.</p>
<div id="exampleQuery" style="text-align:center;max-width:30em;margin:auto;"></div>
<p align="center"><strong>Fig 2. Voronoi Diagram for a NN query.</strong></p>
<h5 id="the-codes-to-create-this-diagram-are-as-follows">The codes to create this diagram are as follows<a hidden class="anchor" aria-hidden="true" href="#the-codes-to-create-this-diagram-are-as-follows">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">queryExample</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">points</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">74</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">118</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">87</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">44</span><span class="p">,</span> <span class="mi">93</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">39</span><span class="p">,</span> <span class="mi">104</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">47</span><span class="p">,</span> <span class="mi">122</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">71</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Function to transform the points so that it would work on the grid
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">transform</span> <span class="o">=</span> <span class="p">(</span><span class="nx">point</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[(</span><span class="nx">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">90</span><span class="p">)</span> <span class="o">*</span> <span class="mi">500</span><span class="p">,</span> <span class="p">(</span><span class="nx">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="mi">500</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">transformed</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">points</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">element</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">transformed</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">transform</span><span class="p">(</span><span class="nx">element</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">delaunay</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">Delaunay</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">points</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">voronoi</span> <span class="o">=</span> <span class="nx">delaunay</span><span class="p">.</span><span class="nx">voronoi</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Call the draw Voronoi function.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">drawVoronoi</span><span class="p">(</span><span class="s2">&#34;#exampleQuery&#34;</span><span class="p">,</span> <span class="nx">transformed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">drawVoronoi</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">vertices</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">height</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">delaunay</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">Delaunay</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">vertices</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">voronoi</span> <span class="o">=</span> <span class="nx">delaunay</span><span class="p">.</span><span class="nx">voronoi</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">id</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;svg&#34;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;viewBox&#34;</span><span class="p">,</span> <span class="sb">`0 0 500 500`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">mesh</span> <span class="o">=</span> <span class="nx">svg</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;path&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;fill&#34;</span><span class="p">,</span> <span class="s2">&#34;none&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke&#34;</span><span class="p">,</span> <span class="s2">&#34;#ccc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke-width&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="nx">voronoi</span><span class="p">.</span><span class="nx">render</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">bounds</span> <span class="o">=</span> <span class="nx">svg</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;path&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;fill&#34;</span><span class="p">,</span> <span class="s2">&#34;none&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke&#34;</span><span class="p">,</span> <span class="s2">&#34;#ccc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke-width&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="nx">voronoi</span><span class="p">.</span><span class="nx">renderBounds</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Find the closest point to this coordinate.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">ans</span> <span class="o">=</span> <span class="nx">delaunay</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">73</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">neighbours</span> <span class="o">=</span> <span class="nx">delaunay</span><span class="p">.</span><span class="nx">neighbors</span><span class="p">(</span><span class="nx">ans</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">iterator</span> <span class="k">of</span> <span class="nx">neighbours</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">renderCell</span><span class="p">(</span><span class="nx">svg</span><span class="p">,</span> <span class="nx">voronoi</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">schemeTableau10</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">renderCell</span><span class="p">(</span><span class="nx">svg</span><span class="p">,</span> <span class="nx">voronoi</span><span class="p">,</span> <span class="nx">ans</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">schemeTableau10</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">points</span> <span class="o">=</span> <span class="nx">svg</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;path&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;fill&#34;</span><span class="p">,</span> <span class="s2">&#34;black&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke&#34;</span><span class="p">,</span> <span class="s2">&#34;#ccc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke-width&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="nx">delaunay</span><span class="p">.</span><span class="nx">renderPoints</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">renderCell</span> <span class="o">=</span> <span class="p">(</span><span class="nx">svg</span><span class="p">,</span> <span class="nx">voronoi</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">svg</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;path&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;fill&#34;</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke&#34;</span><span class="p">,</span> <span class="s2">&#34;#ccc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;stroke-width&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="nx">voronoi</span><span class="p">.</span><span class="nx">renderCell</span><span class="p">(</span><span class="nx">index</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><h4 id="lessons-from-this-blog-post">Lessons from this blog post.<a hidden class="anchor" aria-hidden="true" href="#lessons-from-this-blog-post">#</a></h4>
<ul>
<li>The learning curve for d3.js is <strong>pretty insane.</strong></li>
<li>Voronoi are pretty easy using d3.</li>
<li>Generators can be iterated using the <code>for...of</code> construct. <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators">MDN link</a></li>
<li>There is a way to make SVG responsive. Refer <a href="https://medium.com/@louisemoxy/a-simple-way-to-make-d3-js-charts-svgs-responsive-7afb04bc2e4b">this</a> post.</li>
</ul>
<!-- https://bl.ocks.org/aaizemberg/raw/8063f8c2d1adb7c7ee68/ -->
<!-- https://observablehq.com/@d3/circle-dragging-iii?collection=@d3/d3-delaunay -->
<script>

document.getElementById("theme-toggle").addEventListener("click", () => {
    location.reload()
})


const queryExample = () => {
    
    let points = [[40,74],[34,118],[41,87],[44,93],[39,104],[32,96]
    ,[47,122],[42,71]];

    const transform = point => {
        return [point[0]/90 * 500, point[1]/180*500];
    }

    let transformed = [];
    points.forEach(element => {
        transformed.push(transform(element));
    });
    
    const delaunay = d3.Delaunay.from(points);
    const voronoi = delaunay.voronoi([0, 0, 500, 500]);
    drawVoronoi("#exampleQuery", transformed);
}


const renderCell = (svg, voronoi, index, color) => {
   svg.append("path")
        .attr("fill", color)
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.renderCell(index));   
}

const drawVoronoi = (id, vertices, color) => {
    const width = 500, height = 500;
    const delaunay = d3.Delaunay.from(vertices);
    const voronoi = delaunay.voronoi([0, 0, 500, 500]);
    let svg = d3.select(id)
        .append("svg")
        .attr("viewBox", `0 0 500 500`);
        //.attr("width", width)
        //.attr("height", height);
    
    const mesh = svg.append("path")
        .attr("fill", "none")
        .attr("stroke", "#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.render());

    const bounds = svg.append("path")
        .attr("fill", "none")
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.renderBounds());

    const ans = delaunay.find(40,73);

    for (let index = 0; index < vertices.length; index++) {
        const element = vertices[index];
        renderCell(svg, voronoi, index, d3.schemeTableau10[4]);
    }

    const neighbours = delaunay.neighbors(ans);
    for (const iterator of neighbours) {
        renderCell(svg, voronoi, iterator, d3.schemeTableau10[3]);
    };
     
    renderCell(svg, voronoi, ans, d3.schemeTableau10[0]);
    const points = svg.append("path")
        .attr("fill", "black")
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", delaunay.renderPoints());
};

const drawExampleVoronoi = () => {

    const width = 600, height = 600;
    // const vertices = d3.range(30).map(function(d) {
    //     return [Math.random() * width, Math.random() * height];
    // });

    const radius = 10;
    const circles = d3.range(30).map(i => ({
        x: Math.random() * (width - radius * 2) + radius,
        y: Math.random() * (height - radius * 2) + radius,
    }));

    const delaunay = d3.Delaunay.from(circles, d => d.x, d => d.y);
    const voronoi = delaunay.voronoi([0, 0, width, height]);

    
    let svg = d3.select("#canvas")
        .append("svg")
        .attr("viewBox", `0 0 600 600`);
        // .attr("width", width)
        // .attr("height", height);

    // const circle = svg.append("g")
    // .selectAll("circle")
    // .data(circles)
    // .join("circle")
    //   .attr("cx", d => d.x)
    //   .attr("cy", d => d.y)
    //   .attr("r", radius)
    //   .attr("fill", "black");
    
    const mesh = svg.append("path")
        .attr("fill", "none")
        .attr("stroke", "#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.render());

    const bounds = svg.append("path")
        .attr("fill", "none")
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.renderBounds());

    // for (let index = 0; index < 10; index++) {
    //     svg.append("path")
    //     .attr("fill", d3.schemeTableau10[index % 10])
    //     .attr("stroke","#ccc")
    //     .attr("stroke-width", 1)
    //     .attr("d", voronoi.renderCell(index));
    // }; 

    const points = svg.append("path")
        .attr("fill", "black")
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", delaunay.renderPoints());
};


const drawVoronoiWithPoints = (id, noOfPoints) => {

    let selected = undefined;
    
    const width = 1000, height = 1000;  
    const circles = d3.range(30).map(function(d) {
        return [Math.random() * width, Math.random() * height];
    });

    const query = [Math.random() * width,
        Math.random() * height ];

    const delaunay = d3.Delaunay.from(circles);
    const voronoi = delaunay.voronoi([0, 0, width, height]);

    let svg = d3.select(id)
        .append("svg")
        .attr("viewBox", `0 0 1000 1000`);
     
    const mesh = svg.append("path")
        .attr("fill", "none")
        .attr("stroke", "#ccc")
        .attr("stroke-width", 5)
        .attr("d", voronoi.render());

    const bounds = svg.append("path")
        .attr("fill", "none")
        .attr("stroke","#ccc")
        .attr("stroke-width", 5)
        .attr("d", voronoi.renderBounds());

    const points = () =>  svg.append("path")
        .attr("fill", "black")
        .attr("stroke","#ccc")
        .attr("stroke-width", 2)
        .attr("d", delaunay.renderPoints());

    points();

    svg.on("click", function() {
        var coords = d3.mouse(this);
        var color = "white"
        if (document.body.className.includes("dark")) {
          color = "dark"
        } else {
          color = "white"
        }
        //mesh();
        if (selected != undefined){
            // Determine theme colour

            renderCell(svg, voronoi, selected, color); 
            
            for (const iterator of delaunay.neighbors(selected)) 
                renderCell(svg, voronoi, iterator, color);
            selected = undefined;
        }

        const ans = (delaunay.find(coords[0],coords[1]));
        selected = ans;
        renderCell(svg, voronoi, ans, d3.schemeTableau10[0]);
   
        points();
        //console.log(ans);
        const neighbours = delaunay.neighbors(ans);
        for (const iterator of neighbours) {
            renderCell(svg, voronoi, iterator, d3.schemeTableau10[3]);
        };  
    });
};


//drawExampleVoronoi();
queryExample();
drawVoronoiWithPoints("#canvas",30);

</script>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://jian.sh/tags/nearest-neighbour/">Nearest Neighbour</a></li>
      <li><a href="https://jian.sh/tags/maps/">Maps</a></li>
      <li><a href="https://jian.sh/tags/voronoi/">Voronoi</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://jian.sh/posts/2019/singletonobserverpattern/">
    <span class="title">« Prev</span>
    <br>
    <span>Singleton &amp; Observer Pattern (Java)</span>
  </a>
  <a class="next" href="https://jian.sh/posts/2019/promiseall/">
    <span class="title">Next »</span>
    <br>
    <span>JavaScript Promise All - Parsing Hackernews Stories using Promise.all</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://jian.sh/">Jian</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
