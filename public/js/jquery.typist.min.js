/**
 * jquery.typist
 * @author Alexander Burtsev, http://burtsev.me, 2014
 * @license MIT
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";function b(b,c){a.extend(this,{speed:10,text:"",cursor:!0,blinkSpeed:2,typeFrom:"end",cursorStyles:{display:"inline-block",fontStyle:"normal",margin:"-2px 2px 0 2px"}},c||{}),this._element=a(b),this._element.data("typist",this),this.queue=[],this.timer=null,this.delay=1e3/this.speed,this.blinkTimer=null,this.blinkDelay=1e3/this.blinkSpeed,this.text&&(this.queue.push(this.text),this.type())}a.fn.typist=function(a){return this.each(function(){new b(this,a)})},a.fn.typistAdd=function(b){return this.each(function(){var c=a(this).data("typist");c.queue.push(b),c.type()})},a.fn.typistRemove=function(b){return b=parseInt(b)||0,this.each(function(){var c=a(this).data("typist");c.queue.push({remove:b}),c.type()})},a.fn.typistPause=function(b){return b=parseInt(b)||0,this.each(function(){var c=a(this).data("typist");c.queue.push({delay:b}),c.type()})},a.fn.typistStop=function(){return this.each(function(){var b=a(this).data("typist");b.queue.push({stop:!0}),b.type()})},b.prototype={addCursor:function(){this._cursor&&(clearInterval(this.blinkTimer),this._cursor.stop().remove()),this._cursor=a("<span>|</span>").css(this.cursorStyles).insertAfter(this._container),this.cursorVisible=!0,this.blinkTimer=setInterval(a.proxy(function(){this.cursorVisible=!this.cursorVisible,this._cursor.animate({opacity:this.cursorVisible?1:0},100)},this),this.blinkDelay)},fire:function(a){return this._element.trigger(a,this),this},nl2br:function(a){return a.replace("\n","<br/>")},remove:function(b){if(0>=b)return this.timer=null,this.fire("end_remove.typist").type();b--;var c=this._container.text();c=c.substr(0,c.length-1),c=this.nl2br(c),this.timer=setTimeout(a.proxy(function(){this._container.html(c),this.remove(b)},this),this.delay)},step:function(b){if(!b.length)return this.timer=null,this.fire("end_type.typist").type();var c=b.shift();c=a("<div>").text(c).html(),c=this.nl2br(c),this.timer=setTimeout(a.proxy(function(){this._container.html(this._container.html()+c),this.step(b)},this),this.delay)},stop:function(){clearInterval(this.blinkTimer),this.blinkTimer=null,this._cursor&&(this._cursor.remove(),this._cursor=null),clearTimeout(this.timer),this.timer=null},type:function(){if(!this.timer){this._container||(this._container=a("<span>"),"start"===this.typeFrom?this._element.prepend(this._container):this._element.append(this._container)),this.cursor&&this.addCursor();var b,c=this.queue.shift();if("string"==typeof c)b=c;else{if(c&&c.delay)return void(this.fire("start_pause.typist").timer=setTimeout(a.proxy(function(){this.timer=null,this.fire("end_pause.typist").type()},this),c.delay));if(c&&c.remove)return void this.fire("start_remove.typist").remove(c.remove);if(c&&c.stop)return void this.stop()}b&&(b=b.split(""),this.fire("start_type.typist").step(b))}}}});